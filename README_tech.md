–¢–µ—Ö–Ω—ñ—á–Ω–∏–π —Ä–æ–∑–±—ñ—Ä
–ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ —Ç–∞ –ø—ñ–¥—Ö—ñ–¥

Vanilla JS –±–µ–∑ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫—ñ–≤. –†–æ–±–æ—Ç–∞ –Ω–∞–ø—Ä—è–º—É –∑ DOM —á–µ—Ä–µ–∑ querySelector / querySelectorAll (—Å–∫–æ—Ä–æ—á–µ–Ω–Ω—è $, $$), classList, dataset, —à–∞–±–ª–æ–Ω <template> –¥–ª—è –∫–ª–æ–Ω—É–≤–∞–Ω–Ω—è –∫–∞—Ä—Ç–æ–∫.

–ë–µ–∑ –≥–ª–æ–±–∞–ª—å–Ω–∏—Ö –∑–±—ñ—Ä–æ–∫ —Å—Ç–∞–Ω—É: –ø—Ä–æ—Å—Ç–∏–π –º–æ–¥—É–ª—å —Å—Ö–æ–≤–∏—â–∞ –Ω–∞ localStorage + —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è DOM ‚áÑ JSON.

–ü—Ä–æ–≥—Ä–µ—Å–∏–≤–Ω—ñ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è: –∫–Ω–æ–ø–∫–∞ —Ç–µ–º–∏, –∞–≤—Ç–æ—Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è, ‚Äú–ø–æ–∫–∞–∑–∞—Ç–∏ –±—ñ–ª—å—à–µ/–º–µ–Ω—à–µ‚Äù ‚Äî —É—Å–µ –æ–ø—Ü—ñ–π–Ω–æ, –∑ –¥–µ—Ñ–æ–ª—Ç–∞–º–∏ –π –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è–º —É localStorage.

–ú–æ–¥–µ–ª—å –¥–∞–Ω–∏—Ö —ñ —Å—Ç–∞–Ω

–ö–æ–ª–æ–Ω–∫–∏ —Ñ—ñ–∫—Å–æ–≤–∞–Ω—ñ: Start / Progress / Done (COLUMNS).

–°—Ç–∞–Ω –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è —è–∫ –æ–±‚Äô—î–∫—Ç { Start: Item[], Progress: Item[], Done: Item[] }, –¥–µ Item = { id, title, priority, createdAt }.

–ì–µ–Ω–µ—Ä–∞—Ü—ñ—è id: –∫–æ–º–ø–∞–∫—Ç–Ω–∏–π UID uid() –Ω–∞ –±–∞–∑—ñ Math.random() + Date.now() (—à–≤–∏–¥–∫–æ –π –¥–æ—Å—Ç–∞—Ç–Ω—å–æ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É).

–°—Ö–æ–≤–∏—â–µ:

Store.load()/save()/clear() –∑ try/catch –Ω–∞ –≤–∏–ø–∞–¥–æ–∫ –æ–±–º–µ–∂–µ–Ω—å –¥–æ—Å—Ç—É–ø—É –¥–æ localStorage.

–ö–ª—é—á—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å: STORE_KEY (–¥–∞–Ω—ñ –¥–æ—à–∫–∏), THEME_KEY (—Ç–µ–º–∞), AUTO_SORT_KEY (–∞–≤—Ç–æ—Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è).

–ì—ñ–¥—Ä–∞—Ü—ñ—è –∑ DOM: readFromDOM() –ø—Ä–æ—Ö–æ–¥–∏—Ç—å –ø–æ .place —ñ –∑–±–∏—Ä–∞—î JSON –∑—ñ —Å–ø—Ä–∞–≤–∂–Ω—ñ—Ö –≤—É–∑–ª—ñ–≤ ‚Äî –Ω–∞–¥—ñ–π–Ω–æ —Ç—Ä–∏–º–∞—î —Å—Ç–∞–Ω —É —Å–∏–Ω—Ö—Ä–æ–Ω—ñ –∑ –≤–µ—Ä—Å—Ç–∫–æ—é.

–°—Ç–≤–æ—Ä–µ–Ω–Ω—è/—Ä–µ–Ω–¥–µ—Ä –∫–∞—Ä—Ç–æ–∫

–®–∞–±–ª–æ–Ω: –µ–ª–µ–º–µ–Ω—Ç <template id="item-template"> –∫–ª–æ–Ω—É—é—Ç—å —É makeItemNode(item).

–í—É–∑–æ–ª –Ω–∞–ø–æ–≤–Ω—é—î—Ç—å—Å—è: –∑–∞–≥–æ–ª–æ–≤–æ–∫, –±–µ–π–¥–∂ –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç—É, –∫–Ω–æ–ø–∫–∏ –¥—ñ–π, –∞—Ç—Ä–∏–±—É—Ç–∏ data-* (data-id, data-priority).

–ü—Ä–∏–∫—Ä—ñ–ø–ª–µ–Ω–Ω—è —Ö–µ–Ω–¥–ª–µ—Ä—ñ–≤ –æ–¥—Ä–∞–∑—É –Ω–∞ –≤—É–∑–æ–ª:

edit/delete,

–∫–ª—ñ–∫ –ø–æ –±–µ–π–¥–∂—É ‚Üí —Ü–∏–∫–ª—ñ—á–Ω–∞ –∑–º—ñ–Ω–∞ –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç—É low ‚Üí med ‚Üí high (—Ñ-—Ü—ñ—ó renderBadgePriority, cyclePriority, setPriorityOnNode).

–ü—ñ—Å–ª—è –≤—Å—Ç–∞–≤–∫–∏ ‚Äî queueMicrotask(() => applyClamp(node)), —â–æ–± –ø–æ—Ä–∞—Ö—É–≤–∞—Ç–∏, —á–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–æ–∫–∞–∑—É–≤–∞—Ç–∏ –∫–Ω–æ–ø–∫—É ‚Äú–ü–æ–∫–∞–∑–∞—Ç–∏ –±—ñ–ª—å—à–µ‚Äù (–¥–µ—Ç–∞–ª—ñ –Ω–∏–∂—á–µ).

–†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è (inline editing)

–ü–æ–¥–≤—ñ–π–Ω–∏–π –∫–ª—ñ–∫ –∞–±–æ –∫–Ω–æ–ø–∫–∞ ‚úèÔ∏è –≤—ñ–¥–∫—Ä–∏–≤–∞—î textarea –∑–∞–º—ñ—Å—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∞.

UX —à–æ—Ä—Ç–∫–∞—Ç–∏: Ctrl/Cmd+Enter = –∑–±–µ—Ä–µ–≥—Ç–∏, Esc = —Å–∫–∞—Å—É–≤–∞—Ç–∏, –∞–≤—Ç–æ-–ø—ñ–¥–≥–æ–Ω–∫–∞ –≤–∏—Å–æ—Ç–∏ —á–µ—Ä–µ–∑ scrollHeight.

–ü–æ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ñ —Ä–µ–¥–∞–∫—Ç—É:

–≤—ñ–¥–Ω–æ–≤–ª—é—î—Ç—å—Å—è <span class="title clamp-4">,

—Å–∫–∏–¥–∞—î—Ç—å—Å—è —Å—Ç–∞–Ω –∫–Ω–æ–ø–∫–∏ ‚Äú–ü–æ–∫–∞–∑–∞—Ç–∏ –±—ñ–ª—å—à–µ/–º–µ–Ω—à–µ‚Äù,

–≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è applyClamp(node) —ñ Board.syncFromDOMandSave().

–ë–∞–≥–∞—Ç–æ—Ä—è–¥–∫–æ–≤–∏–π preview (line-clamp) + ‚Äú–ü–æ–∫–∞–∑–∞—Ç–∏ –±—ñ–ª—å—à–µ/–º–µ–Ω—à–µ‚Äù

–í–∏–º—ñ—Ä –ø–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è: needsClamp(titleEl) —Ç–∏–º—á–∞—Å–æ–≤–æ –¥–æ–¥–∞—î –∫–ª–∞—Å clamp-4 —ñ –ø–æ—Ä—ñ–≤–Ω—é—î scrollHeight –∑ clientHeight ‚Äî —è–∫—â–æ —Ç–µ–∫—Å—Ç ‚Äú–≤–∏–ª–∞–∑–∏—Ç—å‚Äù, –ø–æ–∫–∞–∑—É—î–º–æ –∫–Ω–æ–ø–∫—É.

–¢–æ–≥–ª —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è: –∫–ª—ñ–∫ –ø–æ –∫–Ω–æ–ø—Ü—ñ –º—ñ–Ω—è—î –∫–ª–∞—Å clamp-4 —É .title —Ç–∞ —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏; —Å–µ–ª–µ–∫—Ç–æ—Ä –∑–∞–≥–æ–ª–æ–≤–∫–∞ –±–µ—Ä–µ—Ç—å—Å—è ‚Äú–∑ –∂–∏–≤–æ–≥–æ DOM‚Äù –Ω–∞ –∫–æ–∂–µ–Ω –∫–ª—ñ–∫, —â–æ–± –≤—Å–µ –ø—Ä–∞—Ü—é–≤–∞–ª–æ –ø—ñ—Å–ª—è —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è (—É–Ω–∏–∫–∞—î–º–æ –∑–∞—Å—Ç–∞—Ä—ñ–ª–æ–≥–æ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –≤—É–∑–æ–ª).

Drag & Drop (HTML5 DnD)

–•—É–∫–Ω–µ–º–æ –∫–∞—Ä—Ç–∫—É: dragstart —Å—Ç–∞–≤–∏—Ç—å dataTransfer, aria-grabbed, –¥–æ–¥–∞—î –∫–ª–∞—Å–∏ dragging/hold.

–ü—Ä–∏–∑–µ–º–ª–µ–Ω–Ω—è: dragover –∑ preventDefault() —ñ –¥–∏–Ω–∞–º—ñ—á–Ω–∏–º —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–º ‚Äî –≤—Å—Ç–∞–≤–Ω–∏–π <div class="drop-indicator"> –ø–µ—Ä–µ–¥ –µ–ª–µ–º–µ–Ω—Ç–æ–º, –ø—ñ—Å–ª—è —è–∫–æ–≥–æ –≤–ø–∞–¥–µ –∫–∞—Ä—Ç–∫–∞.

–ê–ª–≥–æ—Ä–∏—Ç–º –ø–æ–∑–∏—Ü—ñ–æ–Ω—É–≤–∞–Ω–Ω—è:

getDragAfterElement(container, y) —Ä–∞—Ö—É—î offset = y - (top + height/2) –¥–ª—è –∫–æ–∂–Ω–æ—ó –∫–∞—Ä—Ç–∫–∏ –±–µ–∑ .dragging —ñ –±–µ—Ä–µ –Ω–∞–π–±–ª–∏–∂—á–∏–π ‚Äú–≤–∏—â–µ –∫—É—Ä—Å–æ—Ä–∞‚Äù (–∫–ª–∞—Å–∏—á–Ω–∏–π reduce –ø–æ DOM).

drop –≤—Å—Ç–∞–≤–ª—è—î –µ–ª–µ–º–µ–Ω—Ç (–≤ –∫—ñ–Ω–µ—Ü—å –∞–±–æ –ø–µ—Ä–µ–¥ after), —á–∏—Å—Ç–∏—Ç—å —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä, –æ–ø—Ü—ñ–π–Ω–æ –∑–∞–ø—É—Å–∫–∞—î —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è (–¥–∏–≤. –Ω–∏–∂—á–µ).

dragend –∑–Ω—ñ–º–∞—î –∫–ª–∞—Å–∏, –∑–±–µ—Ä—ñ–≥–∞—î —Å—Ç–∞–Ω.

–°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è –∑–∞ –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç–æ–º (–≤–º–∏–∫–∞—î—Ç—å—Å—è/–≤–∏–º–∏–∫–∞—î—Ç—å—Å—è)

–†–∞–Ω–≥: priorityRank(high=0, med=1, low=2).

sortPlace(place) —Å–æ—Ä—Ç—É—î .item –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–æ–ª–æ–Ω–∫–∏ –ª–∏—à–µ —è–∫—â–æ –∞–≤—Ç–æ—Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è —É–≤—ñ–º–∫–Ω–µ–Ω–æ (isAutoSort() –∑—á–∏—Ç—É—î localStorage).

–Ñ –∫–Ω–æ–ø–∫–∞-–ø–µ—Ä–µ–º–∏–∫–∞—á ‚Äú–ê–≤—Ç–æ—Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è: —É–≤—ñ–º–∫/–≤–∏–º–∫‚Äù ‚Äî —ó—ó —Å—Ç–∞–Ω –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è, –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è —á–µ—Ä–µ–∑ aria-pressed, —ñ –ø—Ä–∏ —É–≤—ñ–º–∫–Ω–µ–Ω–Ω—ñ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è sortAll().

–¢–µ–º–∞ (Dark/Light)

applyTheme(theme) –¥–æ–¥–∞—î/–ø—Ä–∏–±–∏—Ä–∞—î –∫–ª–∞—Å light –Ω–∞ <html>, —â–æ –∞–∫—Ç–∏–≤—É—î CSS –∑–º—ñ–Ω–Ω—ñ –∑ :root.light { ... }.

–ö–Ω–æ–ø–∫–∞ üåó ‚Äî –ø—Ä–æ—Å—Ç–∏–π —Ç–æ–≥–ª –º—ñ–∂ dark/light, –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤ localStorage.

–ù–∞ init() —Ç–µ–º–∞ –∑–∞—Å—Ç–æ—Å–æ–≤—É—î—Ç—å—Å—è –∑–±–µ—Ä–µ–∂–µ–Ω–∏–º –∑–Ω–∞—á–µ–Ω–Ω—è–º.

–ï–∫—Å–ø–æ—Ä—Ç/—ñ–º–ø–æ—Ä—Ç

–ï–∫—Å–ø–æ—Ä—Ç: —Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è readFromDOM() ‚Üí JSON.stringify() ‚Üí Blob ‚Üí URL.createObjectURL() ‚Üí –∞–≤—Ç–æ–∫–ª—ñ–∫ –ø–æ <a download>.

–Ü–º–ø–æ—Ä—Ç: —á–∏—Ç–∞—î–º–æ —Ñ–∞–π–ª .json —á–µ—Ä–µ–∑ File.text(), JSON.parse(), –¥–∞–ª—ñ renderState(data) + Store.save(data).

–û–±–≥–æ—Ä—Ç–∫–∏ —É try/catch —Ç–∞ –æ—á–∏—â–µ–Ω–Ω—è input.value, —â–æ–± –æ–±—Ä–∞—Ç–∏ —Ç–æ–π —Å–∞–º–∏–π —Ñ–∞–π–ª –ø–æ–≤—Ç–æ—Ä–Ω–æ.

–ü–æ–¥—ñ—ó —Ç–∞ –∂–∏—Ç—Ç—î–≤–∏–π —Ü–∏–∫–ª

–¢–æ—á–∫–∞ –≤—Ö–æ–¥—É: DOMContentLoaded ‚Üí Board.init().

Board.init():

–ø—ñ–¥–Ω—ñ–º–∞—î —Ç–µ–º—É,

–ø—ñ–¥–ø–∏—Å—É—î –ø–æ–¥—ñ—ó –Ω–∞ –∫–æ–ª–æ–Ω–∫–∏ (DnD),

–≤—ñ–¥–Ω–æ–≤–ª—é—î –∫–∞—Ä—Ç–∫–∏ –∑—ñ —Å—Ö–æ–≤–∏—â–∞ (–∞–±–æ –¥–æ–¥–∞—î –¥–µ–º–æ),

–Ω–∞–ª–∞—à—Ç–æ–≤—É—î –∫–Ω–æ–ø–∫—É –∞–≤—Ç–æ—Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è,

–ø—ñ–¥–ø–∏—Å—É—î —Ñ–æ—Ä–º—É —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è, –µ–∫—Å–ø–æ—Ä—Ç/—ñ–º–ø–æ—Ä—Ç/–æ—á–∏—â–µ–Ω–Ω—è,

updateCounts() –ø—ñ–¥—Ä–∞—Ö–æ–≤—É—î –∫–∞—Ä—Ç–∫–∏ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö –∫–æ–ª–æ–Ω–æ–∫.

–ë—É–¥—å-—è–∫—ñ –º—É—Ç–∞—Ü—ñ—ó –∑–∞–∫—ñ–Ω—á—É—é—Ç—å—Å—è syncFromDOMandSave() ‚Äî –æ–¥–Ω–∞ —Ç–æ—á–∫–∞ —ñ—Å—Ç–∏–Ω–∏.

–î—Ä—ñ–±–Ω—ñ, –∞–ª–µ –≤–∞–∂–ª–∏–≤—ñ –¥–µ—Ç–∞–ª—ñ

–î–æ—Å—Ç—É–ø–Ω—ñ—Å—Ç—å (ARIA): –ø—ñ–¥ —á–∞—Å drag ‚Äî aria-grabbed, —Ä–æ–ª—ñ/–ª–∞–π–≤-–ª—ñ—á–∏–ª—å–Ω–∏–∫–∏ –≤ —Ä–æ–∑–º—ñ—Ç—Ü—ñ (–≤ HTML), –ø—ñ–¥–∫–∞–∑–∫–∏ —á–µ—Ä–µ–∑ title.

–ù–∞–¥—ñ–π–Ω—ñ—Å—Ç—å: try/catch –¥–ª—è storage —ñ JSON, preventDefault() —É dragover, confirm() –ø–µ—Ä–µ–¥ –≤–∏–¥–∞–ª–µ–Ω–Ω—è–º.

–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å: —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è ‚Äî O(n log n) –Ω–∞ –∫–æ–ª–æ–Ω–∫—É, –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –ª–∏—à–µ –∫–æ–ª–∏ —Ç—Ä–µ–±–∞ (–∞–±–æ –ø–æ –ø–µ—Ä–µ–º–∏–∫–∞—á—É –∞–≤—Ç–æ—Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è).

–ß–∏—Å—Ç–æ—Ç–∞ DOM: —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä –¥—Ä–æ–ø–∞ ‚Äî –æ–¥–∏–Ω –Ω–∞ –≤—Å—é –¥–æ—à–∫—É; –ø—ñ—Å–ª—è –¥—Ä–æ–ø–∞ –ø—Ä–∏–±–∏—Ä–∞—î—Ç—å—Å—è.